<!DOCTYPE html>
<html>
<head>
  <title>Tests Report</title>
  <style>
    .filename {
      padding: 10px;
      margin-bottom: 10px;
      background-color: lightblue;
    }
    .pass {
      background-color: green;
    }
    .fail {
      background-color: red;
    }
    .default {
      background-color: lightgray;
    }
    .testSuite {
      margin-bottom: 20px;
    }
    .singleTest {
      padding: 10px;
    }
    .bdd {
      padding-left: 10px;
    }
    .bddItem {
      padding-left: 10px;
    }
    .testsContainer {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>Tests Report</h1>
  <label><input type="radio" name="jsonFile" value="./tests.json" checked> Documented</label>
  <label><input type="radio" name="jsonFile" value="./orphan.json"> Pending</label>
  <div id="testsContainer"></div>

  <script>
    const testsContainer = document.getElementById('testsContainer');
    const jsonFileRadios = document.querySelectorAll('input[name="jsonFile"]');

    function loadTests(jsonFile) {
      fetch(jsonFile)
        .then(response => response.json())
        .then(data => {
          testsContainer.innerHTML = '';
          data.forEach(item => {
            const json = Object.keys(item)[0];
            const filename = item.filename;
            const tests = item.tests;

            const filenameElement = document.createElement('div');
            filenameElement.textContent = filename;
            filenameElement.classList.add('filename');
            testsContainer.appendChild(filenameElement);

            tests.forEach(test => {
              const testElement = document.createElement('div');
              testElement.classList.add('testSuite');

              const methodElement = document.createElement('p');
              methodElement.textContent = `> ${test.method}`;
              if (test.pass === true) {
                methodElement.classList.add('pass');
              } else if (test.pass === false) {
                methodElement.classList.add('fail');
              } else {
                methodElement.classList.add('default');
              }
              methodElement.classList.add('singleTest');
              filenameElement.appendChild(methodElement);

              if (test.tags != null) {
                const tagsElement = document.createElement('p');
                tagsElement.textContent = `Tags: ${test.tags.join(', ')}`;
                methodElement.appendChild(tagsElement);
              }

              if (test.block.given != null) {
                const giveElement = document.createElement('p');
                giveElement.textContent = 'Given:';
                giveElement.classList.add('bdd');
                methodElement.appendChild(giveElement);
                test.block.given.forEach(value => {
                  const valueElement = document.createElement('p');
                  valueElement.textContent = `- ${value}`;
                  valueElement.classList.add('bddItem');
                  giveElement.appendChild(valueElement);
                });
              }

              if (test.block.when != null) {
                const whenElement = document.createElement('p');
                whenElement.textContent = 'When:';
                whenElement.classList.add('bdd');
                methodElement.appendChild(whenElement);
                test.block.when.forEach(value => {
                  const valueElement = document.createElement('p');
                  valueElement.textContent = `- ${value}`;
                  valueElement.classList.add('bddItem');
                  whenElement.appendChild(valueElement);
                });
              }

              if (test.block.then != null) {
                const thenElement = document.createElement('p');
                thenElement.textContent = 'Then:';
                thenElement.classList.add('bdd');
                methodElement.appendChild(thenElement);
                test.block.then.forEach(value => {
                  const valueElement = document.createElement('p');
                  valueElement.textContent = `- ${value}`;
                  valueElement.classList.add('bddItem');
                  thenElement.appendChild(valueElement);
                });
              }

              testsContainer.appendChild(testElement);
            });
          });
        })
        .catch(error => {
          console.error('Error loading JSON file:', error);
        });
    };

    // Load tests.json by default
    loadTests('./tests.json');

    // Add event listeners to the radio buttons
    jsonFileRadios.forEach(radio => {
      radio.addEventListener('change', () => {
        const selectedJsonFile = radio.value;
        loadTests(selectedJsonFile);
      });
    });
</script>